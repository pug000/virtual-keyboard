(()=>{"use strict";const e={langIndex:0,capsLock:!1,shift:!1,alt:!1,ctrl:!1};class t{node;constructor(e,t="div",i=""){const a=document.createElement(t);i&&(a.className=i),e&&e.append(a),this.node=a}destroy(){this.node.remove()}}class i extends t{constructor(e){super(e,"div","background"),this.node.innerHTML='<video playsinline autoplay loop muted poster="https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/items/874400/14e1a261b94ebe19eac8234a9c7e4abaae1084bb.jpg"><source src="https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/items/874400/2fda5d3781c6d198d70775f53809db245151928d.mp4" type="video/mp4"><source src="https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/items/874400/c6ec1e32708cb1e403a4c79db03b0128e080e1e8.webm" type="video/webm"></video>'}}const a={defaultState:{Backquote:"`",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"BACKSPACE",Tab:"TAB",KeyQ:"q",KeyW:"w",KeyE:"e",KeyR:"r",KeyT:"t",KeyY:"y",KeyU:"u",KeyI:"i",KeyO:"o",KeyP:"p",BracketLeft:"[",BracketRight:"]",Backslash:"\\",Delete:"DEL",CapsLock:"CAPSLOCK",KeyA:"a",KeyS:"s",KeyD:"d",KeyF:"f",KeyG:"g",KeyH:"h",KeyJ:"j",KeyK:"k",KeyL:"l",Semicolon:";",Quote:"'",Enter:"ENTER",ShiftLeft:"SHIFT",KeyZ:"z",KeyX:"x",KeyC:"c",KeyV:"v",KeyB:"b",KeyN:"n",KeyM:"m",Comma:",",Period:".",Slash:"/",ArrowUp:"↑",ShiftRight:"SHIFT",ControlLeft:"CTRL",SwitchLang:"RUS",AltLeft:"ALT",Space:"SPACE",AltRight:"ALT",ArrowLeft:"←",ArrowDown:"↓",ArrowRight:"→",ControlRight:"CTRL"},shiftState:{Backquote:"~",Digit1:"!",Digit2:"@",Digit3:"#",Digit4:"$",Digit5:"%",Digit6:"^",Digit7:"&",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",Backspace:"BACKSPACE",Tab:"TAB",KeyQ:"Q",KeyW:"W",KeyE:"E",KeyR:"R",KeyT:"T",KeyY:"Y",KeyU:"U",KeyI:"I",KeyO:"O",KeyP:"P",BracketLeft:"{",BracketRight:"}",Backslash:"|",Delete:"DEL",CapsLock:"CAPSLOCK",KeyA:"A",KeyS:"S",KeyD:"D",KeyF:"F",KeyG:"G",KeyH:"H",KeyJ:"J",KeyK:"K",KeyL:"L",Semicolon:":",Quote:'"',Enter:"ENTER",ShiftLeft:"SHIFT",KeyZ:"Z",KeyX:"X",KeyC:"C",KeyV:"V",KeyB:"B",KeyN:"N",KeyM:"M",Comma:"<",Period:">",Slash:"?",ArrowUp:"↑",ShiftRight:"SHIFT",ControlLeft:"CTRL",SwitchLang:"RUS",AltLeft:"ALT",Space:"SPACE",AltRight:"ALT",ArrowLeft:"←",ArrowDown:"↓",ArrowRight:"→",ControlRight:"CTRL"},shiftLowState:{Backquote:"~",Digit1:"!",Digit2:"@",Digit3:"#",Digit4:"$",Digit5:"%",Digit6:"^",Digit7:"&",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",Backspace:"BACKSPACE",Tab:"TAB",KeyQ:"q",KeyW:"w",KeyE:"e",KeyR:"r",KeyT:"t",KeyY:"y",KeyU:"u",KeyI:"i",KeyO:"o",KeyP:"p",BracketLeft:"{",BracketRight:"}",Backslash:"|",Delete:"DEL",CapsLock:"CAPSLOCK",KeyA:"a",KeyS:"s",KeyD:"d",KeyF:"f",KeyG:"g",KeyH:"h",KeyJ:"j",KeyK:"k",KeyL:"l",Semicolon:":",Quote:'"',Enter:"ENTER",ShiftLeft:"SHIFT",KeyZ:"z",KeyX:"x",KeyC:"c",KeyV:"v",KeyB:"b",KeyN:"n",KeyM:"m",Comma:"<",Period:">",Slash:"?",ArrowUp:"↑",ShiftRight:"SHIFT",ControlLeft:"CTRL",SwitchLang:"RUS",AltLeft:"ALT",Space:"SPACE",AltRight:"ALT",ArrowLeft:"←",ArrowDown:"↓",ArrowRight:"→",ControlRight:"CTRL"},capsLockState:{Backquote:"`",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"BACKSPACE",Tab:"TAB",KeyQ:"Q",KeyW:"W",KeyE:"E",KeyR:"R",KeyT:"T",KeyY:"Y",KeyU:"U",KeyI:"I",KeyO:"O",KeyP:"P",BracketLeft:"[",BracketRight:"]",Backslash:"\\",Delete:"DEL",CapsLock:"CAPSLOCK",KeyA:"A",KeyS:"S",KeyD:"D",KeyF:"F",KeyG:"G",KeyH:"H",KeyJ:"J",KeyK:"K",KeyL:"L",Semicolon:";",Quote:"'",Enter:"ENTER",ShiftLeft:"SHIFT",KeyZ:"Z",KeyX:"X",KeyC:"C",KeyV:"V",KeyB:"B",KeyN:"N",KeyM:"M",Comma:",",Period:".",Slash:"/",ArrowUp:"↑",ShiftRight:"SHIFT",ControlLeft:"CTRL",SwitchLang:"RUS",AltLeft:"ALT",Space:"SPACE",AltRight:"ALT",ArrowLeft:"←",ArrowDown:"↓",ArrowRight:"→",ControlRight:"CTRL"}},s={defaultState:{Backquote:"ё",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"BACKSPACE",Tab:"TAB",KeyQ:"й",KeyW:"ц",KeyE:"у",KeyR:"к",KeyT:"е",KeyY:"н",KeyU:"г",KeyI:"ш",KeyO:"щ",KeyP:"з",BracketLeft:"х",BracketRight:"ъ",Backslash:"\\",Delete:"DEL",CapsLock:"CAPSLOCK",KeyA:"ф",KeyS:"ы",KeyD:"в",KeyF:"а",KeyG:"п",KeyH:"р",KeyJ:"о",KeyK:"л",KeyL:"д",Semicolon:"ж",Quote:"э",Enter:"ENTER",ShiftLeft:"SHIFT",KeyZ:"я",KeyX:"ч",KeyC:"с",KeyV:"м",KeyB:"и",KeyN:"т",KeyM:"ь",Comma:"б",Period:"ю",Slash:".",ArrowUp:"↑",ShiftRight:"SHIFT",ControlLeft:"CTRL",SwitchLang:"RUS",AltLeft:"ALT",Space:"SPACE",AltRight:"ALT",ArrowLeft:"←",ArrowDown:"↓",ArrowRight:"→",ControlRight:"CTRL"},shiftState:{Backquote:"Ё",Digit1:"!",Digit2:'"',Digit3:"№",Digit4:";",Digit5:"%",Digit6:":",Digit7:"?",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",Backspace:"BACKSPACE",Tab:"TAB",KeyQ:"Й",KeyW:"Ц",KeyE:"У",KeyR:"К",KeyT:"Е",KeyY:"Н",KeyU:"Г",KeyI:"Ш",KeyO:"Щ",KeyP:"З",BracketLeft:"Х",BracketRight:"Ъ",Backslash:"/",Delete:"DEL",CapsLock:"CAPSLOCK",KeyA:"Ф",KeyS:"Ы",KeyD:"В",KeyF:"А",KeyG:"П",KeyH:"Р",KeyJ:"О",KeyK:"Л",KeyL:"Д",Semicolon:"Ж",Quote:"Э",Enter:"ENTER",ShiftLeft:"SHIFT",KeyZ:"Я",KeyX:"Ч",KeyC:"С",KeyV:"М",KeyB:"И",KeyN:"Т",KeyM:"Ь",Comma:"Б",Period:"Ю",Slash:",",ArrowUp:"↑",ShiftRight:"SHIFT",ControlLeft:"CTRL",SwitchLang:"RUS",AltLeft:"ALT",Space:"SPACE",AltRight:"ALT",ArrowLeft:"←",ArrowDown:"↓",ArrowRight:"→",ControlRight:"CTRL"},shiftLowState:{Backquote:"Ё",Digit1:"!",Digit2:'"',Digit3:"№",Digit4:";",Digit5:"%",Digit6:":",Digit7:"?",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",Backspace:"BACKSPACE",Tab:"TAB",KeyQ:"й",KeyW:"ц",KeyE:"у",KeyR:"к",KeyT:"е",KeyY:"н",KeyU:"г",KeyI:"ш",KeyO:"щ",KeyP:"з",BracketLeft:"х",BracketRight:"ъ",Backslash:"/",Delete:"DEL",CapsLock:"CAPSLOCK",KeyA:"ф",KeyS:"ы",KeyD:"в",KeyF:"а",KeyG:"п",KeyH:"р",KeyJ:"о",KeyK:"л",KeyL:"д",Semicolon:"ж",Quote:"э",Enter:"ENTER",ShiftLeft:"SHIFT",KeyZ:"я",KeyX:"ч",KeyC:"с",KeyV:"м",KeyB:"и",KeyN:"т",KeyM:"ь",Comma:"б",Period:"ю",Slash:",",ArrowUp:"↑",ShiftRight:"SHIFT",ControlLeft:"CTRL",SwitchLang:"RUS",AltLeft:"ALT",Space:"SPACE",AltRight:"ALT",ArrowLeft:"←",ArrowDown:"↓",ArrowRight:"→",ControlRight:"CTRL"},capsLockState:{Backquote:"Ё",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"BACKSPACE",Tab:"TAB",KeyQ:"Й",KeyW:"Ц",KeyE:"У",KeyR:"К",KeyT:"Е",KeyY:"Н",KeyU:"Г",KeyI:"Ш",KeyO:"Щ",KeyP:"З",BracketLeft:"Х",BracketRight:"Ъ",Backslash:"\\",Delete:"DEL",CapsLock:"CAPSLOCK",KeyA:"Ф",KeyS:"Ы",KeyD:"В",KeyF:"А",KeyG:"П",KeyH:"Р",KeyJ:"О",KeyK:"Л",KeyL:"Д",Semicolon:"Ж",Quote:"Э",Enter:"ENTER",ShiftLeft:"SHIFT",KeyZ:"Я",KeyX:"Ч",KeyC:"С",KeyV:"М",KeyB:"И",KeyN:"Т",KeyM:"Ь",Comma:"Б",Period:"Ю",Slash:".",ArrowUp:"↑",ShiftRight:"SHIFT",ControlLeft:"CTRL",SwitchLang:"RUS",AltLeft:"ALT",Space:"SPACE",AltRight:"ALT",ArrowLeft:"←",ArrowDown:"↓",ArrowRight:"→",ControlRight:"CTRL"}};class o{functionalKeys;languages;constructor(e){this.functionalKeys=e,this.languages=[a,s]}change=new class{actions;constructor(){this.actions=[]}add(e){this.actions.push(e)}remove(e){this.actions=this.actions.filter((t=>t!==e))}emit(e){this.actions.forEach((t=>t(e)))}};get data(){return this.functionalKeys}set data(e){this.functionalKeys=e,this.change.emit(this.functionalKeys)}}const n=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace","Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","Delete","CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter","ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight","ControlLeft","SwitchLang","AltLeft","Space","AltRight","ArrowLeft","ArrowDown","ArrowRight","ControlRight"];class c extends t{textarea;state;value;constructor(e,t,i,a){super(e,"div",`keyboard__key ${t}`),this.textarea=i,this.state=a,this.value=t,this.node.onmousedown=()=>{this.addActive()},this.node.onmouseup=()=>{this.removeActive(),this.input()},this.node.onmouseleave=()=>{this.removeActive()}}eventDown=e=>{this.addActive(),this.input()};eventUp=()=>{this.removeActive()};addActive(){this.node.classList.add("active")}removeActive(){this.node.classList.remove("active")}input=()=>{let{position:e}=this.textarea;this.textarea.addChar(e,this.value),e+=1,this.textarea.node.setSelectionRange(e,e)};setKey=e=>{this.value=e,this.node.textContent=e}}class h extends c{constructor(e,t,i,a){super(e,t,i,a),this.node.onmousedown=()=>{super.addActive(),this.holdDown()},this.node.onmouseup=()=>{super.removeActive(),this.holdUp()},this.node.onmouseleave=()=>{super.removeActive(),this.holdUp()}}eventDown=e=>{e.repeat||(super.addActive(),this.holdDown())};eventUp=()=>{super.removeActive(),this.holdUp()};holdDown=()=>{const{state:e}=this;e.data={...e.data,shift:!0},e.data.alt&&(e.data={...e.data,langIndex:(e.data.langIndex+1)%e.languages.length})};holdUp=()=>{const{state:e}=this;e.data={...e.data,shift:!1}}}class y extends c{input=()=>{const{position:e}=this.textarea;this.textarea.addChar(e,"")}}class r extends c{constructor(e,t,i,a){super(e,t,i,a),this.node.onmousedown=()=>{super.addActive(),this.holdDown()},this.node.onmouseup=()=>{super.removeActive(),this.holdUp()},this.node.onmouseleave=()=>{super.removeActive(),this.holdUp()}}eventDown=e=>{e.repeat||(super.addActive(),this.holdDown())};eventUp=()=>{super.removeActive(),this.holdUp()};holdDown=()=>{const{state:e}=this;e.data={...e.data,alt:!0},e.data.shift&&(e.data={...e.data,langIndex:(e.data.langIndex+1)%e.languages.length})};holdUp=()=>{const{state:e}=this;e.data={...e.data,alt:!1}}}const K={Backspace:class extends c{input=()=>{let{position:e}=this.textarea;this.textarea.removeBeforeChar(e),e-=1,this.textarea.node.setSelectionRange(e,e)}},Delete:class extends c{input=()=>{const{position:e}=this.textarea;this.textarea.removeAfterChar(e),this.textarea.node.setSelectionRange(e,e)}},Enter:class extends c{input=()=>{let{position:e}=this.textarea;this.textarea.addChar(e,"\n"),e+=1,this.textarea.node.setSelectionRange(e,e)}},Space:class extends c{input=()=>{let{position:e}=this.textarea;this.textarea.addChar(e," "),e+=1,this.textarea.node.setSelectionRange(e,e)}},Tab:class extends c{input=()=>{let{position:e}=this.textarea;this.textarea.addChar(e,"\t"),e+=1,this.textarea.node.setSelectionRange(e,e)}},SwitchLang:class extends c{input=()=>{const{state:e}=this;e.data={...e.data,langIndex:(e.data.langIndex+1)%e.languages.length}}},CapsLock:class extends c{eventDown=e=>{e.repeat||(super.addActive(),this.input())};input=()=>{const{position:e}=this.textarea;this.textarea.addChar(e,"");const{state:t}=this;t.data={...t.data,capsLock:!t.data.capsLock},t.data.shift&&(t.data={...t.data,shift:!t.data.shift})}},ShiftLeft:h,ShiftRight:h,ControlLeft:y,ControlRight:y,AltLeft:r,AltRight:r};class d extends t{keyMap={};constructor(e,t,i,a){super(e,"div","body-keyboard"),this.keyMap={},t.forEach((e=>{const t=new(K[e]||c)(this.node,e,i,a);this.keyMap[e]=t}))}switchLanguage=e=>{Object.keys(e).forEach((t=>{this.keyMap[t].setKey(e[t])}))};handleDown=(e,t)=>{const i=this.keyMap[e];i&&i.eventDown(t)};handleUp=e=>{const t=this.keyMap[e];t&&t.eventUp()}}class l extends t{constructor(e){super(e,"textarea","textarea"),this.node.spellcheck=!1,this.node.placeholder="Клавиатура создана в операционной системе Windows.\nПереключение языка: Shift + Alt."}get position(){return this.node.selectionStart}addChar=(e,t)=>{const i=this.node.value.slice(0,e),a=this.node.value.slice(e);this.node.value=i+t+a,this.node.focus()};removeBeforeChar=e=>{if(0===e)return;const t=this.node.value.slice(0,e),i=this.node.value.slice(e);this.node.value=t.slice(0,-1)+i,this.node.focus()};removeAfterChar=e=>{const t=this.node.value.slice(0,e),i=this.node.value.slice(e);this.node.value=t+i.substring(1),this.node.focus()}}class g extends t{state;keyboard;textarea;constructor(e,t){super(e,"div","container"),this.state=new o(t);const i=e=>{const t=this.state.languages[e.langIndex];e.capsLock?this.keyboard.switchLanguage(t.capsLockState):e.shift?this.keyboard.switchLanguage(t.shiftState):this.keyboard.switchLanguage(t.defaultState)};this.state.change.add(i),this.textarea=new l(this.node),this.keyboard=new d(this.node,n,this.textarea,this.state),document.addEventListener("keydown",(e=>{e.preventDefault(),this.keyboard.handleDown(e.code,e)})),document.addEventListener("keyup",(e=>{this.keyboard.handleUp(e.code)})),i(this.state.data)}}class u{body;constructor(e,t){this.body=e,this.body=e,new i(this.body),new g(this.body,t)}}window.onload=()=>{new u(document.body,e)}})();